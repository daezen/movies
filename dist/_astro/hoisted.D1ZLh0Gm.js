function r(t,e){return(e||document).querySelector(t)}const a=(t,e,s,i)=>{t.addEventListener(e,s,!!i)},m=(t,e,s,i)=>{t.removeEventListener(e,s,!!i)},g={method:"GET",headers:{accept:"application/json",Authorization:"Bearer eyJhbGciOiJIUzI1NiJ9.eyJhdWQiOiJlMGI1NDAxZjVmNGZkMjRiOTJkYmMyOGVkYmJmMWU5MyIsInN1YiI6IjY1ZjVmYTgwODFkYTM5MDE4NjYxNTJjZSIsInNjb3BlcyI6WyJhcGlfcmVhZCJdLCJ2ZXJzaW9uIjoxfQ.3UWDsNuJsyGQ_UQSFZ7Hkq0UqcvOMmQwwKpVnE_8jaw"}},y="https://image.tmdb.org/t/p/",b={sm:"w300",md:"w780",lg:"w1280",og:"original"};function T(t,e){return t===null?"None":y+b[e||"md"]+t}function _(t){return t.cast.filter(s=>s.known_for_department==="Acting")}function x(t){if(!t||t.length===0)return"None";const e=t.find(i=>i.iso_3166_1==="US");if(!e||!e.release_dates||e.release_dates.length===0)return"None";const s=e.release_dates.find(i=>i.certification!=="");return s?s.certification:"None"}class L{constructor(){this.$=r("[data-overview]"),this.$img=r("[data-overview-img]"),this.$trailer=r("[data-overview-trailer]"),this.$likes=r("[data-overview-likes]"),this.$year=r("[data-overview-year]"),this.$rating=r("[data-overview-rating]"),this.$duration=r("[data-overview-duration]"),this.$description=r("[data-overview-description]"),this.$cast=r("[data-overview-cast]"),this.$categories=r("[data-overview-categories]"),this.$morelike=r("[data-overview-morelike]")}toggle(e){e&&this.$.classList.add("overview--show"),e||(this.setImg("",""),this.$.classList.remove("overview--show"))}async update(e){setTimeout(async()=>{const s=o=>`https://image.tmdb.org/t/p/original/${o}`,n=await(await fetch(`https://api.themoviedb.org/3/movie/${e}?append_to_response=videos%2Cimages%2Ccredits%2Crelease_dates%2Crecommendations&language=en`,g)).json(),h=n.videos.results.find(o=>o.type=="Trailer");if(h!==void 0){const o=`https://youtu.be/${h.key}`;this.setTrailer(o)}else this.setTrailer(!1);n.images.backdrops[0]!=null?this.setImg(s(n.images.backdrops[0].file_path),"Movie poster"):this.setImg(s(n.backdrop_path),"Movie Poster"),this.setLikes(Math.round(n.vote_average)/10*100),this.setYear(new Date(n.release_date).getFullYear()),this.setRating(x(n.release_dates.results)),this.setDescription(n.overview),this.setCast(_(n.credits).map(o=>o.name).slice(0,3)),this.setCategories(n.genres.map(o=>o.name)),this.setMorelike(n.recommendations.results),this.setDuration(n.runtime)},400)}setImg(e,s){this.$img.src=e,this.$img.alt=s}setTrailer(e){this.$trailer.href=e}setLikes(e){this.$likes.textContent=`${e}%`}setYear(e){this.$year.textContent=e}setRating(e){this.$rating.textContent=e}setDuration(e){const s=Math.floor(e/60),i=e%60;e={hours:s,remainingMinutes:i},this.$duration.textContent=`${e.hours}h ${e.remainingMinutes}m`}setDescription(e){this.$description.textContent=e}setCast(e){this.$cast.innerHTML="",e.forEach((s,i)=>{if(i===0)return this.$cast.innerHTML+=`<span class="text-zinc-500">Cast: </span>${s}, `;if(i===e.length-1)return this.$cast.innerHTML+=`${s} and <i>more</i>`;this.$cast.innerHTML+=`${s}, `})}setCategories(e){this.$categories.innerHTML="",e.forEach((s,i)=>{if(i===0)return this.$categories.innerHTML+=`<span class="text-zinc-500">Genres: </span>${s}, `;if(i===e.length-1)return this.$categories.innerHTML+=`${s}`;this.$categories.innerHTML+=`${s}, `})}setMorelike(e){e=e.filter(s=>s.backdrop_path!==null).slice(0,3),this.$morelike.innerHTML="",e.forEach(s=>{this.$morelike.innerHTML+=`
      <div id="${s.id}" data-overview-morelike-preview class="aspect-video skeleton h-36 rounded-md  bg-zinc-800 cursor-pointer group">
        <img src="https://image.tmdb.org/t/p/original/${s.backdrop_path}" alt="${s.title}" class="mb-2 h-full pointer-events-none" />
        <p class="text-base truncate max-w-[250px] group-hover:text-rose-300 transition">${s.title}</p>
      </div>`})}}const u=new L,$=r("[data-carousels]");let f={l:0,x:0},c;function C({target:t,pageX:e}){c=t.closest("[data-carousel]"),c!==null&&(f={l:c.scrollLeft,x:e-c.offsetLeft},a(document,"mousemove",w),a(document,"mouseup",k))}function w({pageX:t}){const i=(t-c.offsetLeft-f.x)*2;c.scrollLeft=f.l-i}function k(){m(document,"mousemove",w),m(document,"mouseup",k)}async function I(t){if(t.target.matches("[data-play]"))return await j(t);t.target.matches("[data-link]")&&(t.preventDefault(),u.toggle(!0),u.update(t.target.id))}async function j(t){t.preventDefault();const e=await fetch(`https://api.themoviedb.org/3/movie/${t.target.id}/videos`,g),{results:s}=await e.json(),i=s?.filter(n=>n.type=="Trailer");try{window.open(`https://youtu.be/${i[0].key}`,"_blank")}catch(n){console.log(n)}}a($,"mousedown",C);a($,"click",I);const l=r("input"),M=()=>l.value==="",p=r("[data-results]"),d={$:r("[data-results]"),isOpen:!1,hide(){this.$.style.display="none",this.isOpen=!1},show(){this.$.removeAttribute("style"),this.isOpen=!0}};function H(){if(M())return d.hide();G(l.value)}function D(t){t.keyCode===27&&(l.value="",d.hide())}function J(){M()||d.show()}function N(t){if(p.innerHTML=null,t=E(t),t==""){const e=v(null,null,null,null);p.insertAdjacentHTML("beforeend",e)}t.forEach(e=>{const s=v(e.backdrop_path,e.title,e.release_date,e.id);p.insertAdjacentHTML("beforeend",s)}),d.show()}function E(t){return t?.filter(e=>e.backdrop_path&&e.hasOwnProperty("release_date")&&e.release_date!=="")}function v(t,e,s,i){let n="";return t===null&&e===null&&s===null?n=`
              <div class="text-xl flex gap-4 h-36 w-full items-center justify-center">
                  <p class="truncate">No results</p>
              </div>`:(t=T(t,"sm"),s=new Date(s).getFullYear(),n=`
              <a id="${i}" class="text-base h-36 flex gap-4 cursor-pointer group">
                <div class="h-full aspect-video rounded-lg overflow-hidden flex-initial">
                  <img src="${t}" alt="Movie poster" loading="lazy" class="h-full w-full saturate-50 group-hover:saturate-100 transition" />
                </div>
                <div class="w-3/5">
                  <p class="truncate group-hover:text-rose-300 transition">${e}</p>
                  <p class="font-light text-zinc-300 group-hover:text-zinc-500 transition">${s}</p>
                </div>
              </a>`),n}async function O(t){const e=await fetch(`https://api.themoviedb.org/3/search/movie?query=${t}&include_adult=false&language=en-US&page=1`,g),{results:s}=await e.json();N(s)}function Y(t,e){let s;return(...i)=>{clearTimeout(s),s=setTimeout(()=>{t.apply(this,i)},e)}}const G=Y(O,300);a(document,"mouseup",({clientX:t,clientY:e})=>{const{left:s,right:i,top:n,bottom:h}=d.$.getBoundingClientRect();document.activeElement!==l&&(t<s||t>i||e<n||e>h)&&d.hide()});a(p,"click",t=>{u.update(t.target.closest("a").id),u.toggle(!0)});a(l,"focus",J);a(l,"keydown",D);a(l,"input",H);a(r("[data-overview-morelike]"),"click",t=>{t.target.matches("[data-overview-morelike-preview]")&&u.update(t.target.id)});a(r("[data-overview-close]"),"click",()=>u.toggle(!1));
